test case: https://docs.google.com/spreadsheets/d/1kGILD7PXdb-vn0eaLzHKzAXt__YUMzz4zLnEsMR9i6c/edit?usp=sharing
